---
title: "Bobalites Project"
author: "Roanna Lin"
date: "April 20, 2016"
output: html_document
---

```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
library(httr)
library(jsonlite)
```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments()
```

```{r}
#Load the files
##replace dir path with location of files on your computer
dir <- "/Users/ellieliu/Desktop/Bobalites/"
businessesmini <- stream_in(file(paste(dir,"businessesmini.json",sep="")))
businesses <- stream_in(file(paste(dir,"yelp_academic_dataset_business.json",sep="")))
categories <- businesses$categories

#Make a vector with the unique business id's for all the rows where 'categories' contains 'Restaurants'
Restaurants <- c()
for (i in 1:length(categories)) {
  if (sum(grepl("Restaurants",categories[[i]]) > 0)) {
    Restaurants <- c(Restaurants,businesses[i,1])
  }
}

#Select the rows in the data frame where the row number is in Restaurants
businessesnarrow <- data.frame(businesses$business_id,businesses$name,businesses$stars,businesses$attributes$"Parking",businesses$attributes$"Wi-Fi",businesses$attributes$"Outdoor Seating",businesses$attributes$"Good For",businesses$attributes$"Accepts Credit Cards",businesses$attributes$"Price Range")
Restaurants_frame <- businessesnarrow %>%
  filter(businesses.business_id %in% Restaurants)
```

```{r}
#Select columns businesses.name, businesses.stars, businesses.attributes..Price.Range., garage, street, lot and valet
#Filter the case that offer either garage, street, lot and valet parking
Restaurants_Parking <- Restaurants_frame %>%
  select(businesses.name, businesses.stars, businesses.attributes..Price.Range., garage, street, lot, valet) %>%
  filter(garage == TRUE | street == TRUE | lot == TRUE | valet == TRUE)

#Compare how does offering different type of parking relate to business stars and business prices
Restaurants_Parkingnarrow <- Restaurants_Parking %>%
  gather(key=parking_options, value, -businesses.name, -businesses.stars, -businesses.attributes..Price.Range.) %>%
  filter(value == TRUE)

Restaurants_Parkingnarrow %>%
  ggplot(aes(y=businesses.stars, x=parking_options)) + 
  geom_boxplot(aes(color=parking_options, fill=parking_options), 
               alpha=.25, outlier.size=1, outlier.colour="gray") +
                 ylab("Stars") + xlab("Parking_Options") + 
                 geom_smooth()

Restaurants_Parkingnarrow %>%
  ggplot(aes(y=businesses.attributes..Price.Range., x=parking_options)) + 
  geom_boxplot(aes(color=parking_options, fill=parking_options), 
               alpha=.25, outlier.size=1, outlier.colour="gray") +
                 ylab("Price") + xlab("Parking_Options")

#Compare how offering or not offering the specific type of parking options (garage, street, lot, valet) impact the business stars and business prices

#Garage 
Restaurants_Parking %>%
  ggplot(aes(x=businesses.stars)) + 
  geom_density(aes(color=garage, fill=garage), alpha=.25) + 
  xlab("Stars") + ylab( "Density")

Restaurants_Parking %>%
  ggplot(aes(x=businesses.attributes..Price.Range.)) + 
  geom_density(aes(color=garage, fill=garage), alpha=.25) + 
  xlab("Prices") + ylab( "Density")

#Street
Restaurants_Parking %>%
  ggplot(aes(x=businesses.stars)) + 
  geom_density(aes(color=street, fill=street), alpha=.25) + 
  xlab("Stars") + ylab( "Density")

Restaurants_Parking %>%
  ggplot(aes(x=businesses.attributes..Price.Range.)) + 
  geom_density(aes(color=street, fill=street), alpha=.25) + 
  xlab("Prices") + ylab( "Density")

#lot
Restaurants_Parking %>%
  ggplot(aes(x=businesses.stars)) + 
  geom_density(aes(color=lot, fill=lot), alpha=.25) + 
  xlab("Stars") + ylab( "Density")

Restaurants_Parking %>%
  ggplot(aes(x=businesses.attributes..Price.Range.)) + 
  geom_density(aes(color=lot, fill=lot), alpha=.25) + 
  xlab("Prices") + ylab( "Density")

#valet
Restaurants_Parking %>%
  ggplot(aes(x=businesses.stars)) + 
  geom_density(aes(color=valet, fill=valet), alpha=.25) + 
  xlab("Stars") + ylab( "Density")

Restaurants_Parking %>%
  ggplot(aes(x=businesses.attributes..Price.Range.)) + 
  geom_density(aes(color=valet, fill=valet), alpha=.25) + 
  xlab("Prices") + ylab( "Density")

```


